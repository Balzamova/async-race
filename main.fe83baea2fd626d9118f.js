(()=>{"use strict";var e={513:(e,t,n)=>{n.r(t)},933:(e,t,n)=>{n.r(t)},749:(e,t,n)=>{n.r(t)},394:(e,t,n)=>{n.r(t)},171:(e,t,n)=>{n.r(t)},720:(e,t,n)=>{n.r(t)},741:(e,t,n)=>{n.r(t)},987:(e,t,n)=>{n.r(t)},307:(e,t,n)=>{n.r(t)},752:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(307);const a=i(n(438));t.default=class{constructor(e){this.rootElement=e,this.baseWrapper=new a.default,this.rootElement.appendChild(this.baseWrapper.element)}}},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}}},140:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(513);const s=a(n(836)),r=a(n(583)),o=a(n(599)),l=a(n(250)),d=a(n(332)),c=a(n(908)),h=a(n(479));class u extends r.default{constructor(){super("div",["content"]),this.navigation=new c.default,this.garagePage=new l.default,this.scorePage=new d.default,this.api=new s.default,this.currentCarId=0,this.currentName="",this.currentColor="",this.element.appendChild(this.navigation.element),this.element.appendChild(this.garagePage.element),this.element.appendChild(this.scorePage.element),this.listen()}checkDB(e){return i(this,void 0,void 0,(function*(){const t=[];for(let n=0;n<e.length;n++)t.push(new o.default(e[n].name,e[n].color,e[n].id));this.garagePage.garage.block.addCars(t),this.garagePage.garage.page.garageCarsCount(),this.garagePage.pagination.checkBtnsDisabled("garage"),this.garagePage.controls.raceBtnDisabled(!1),yield this.scorePage.getWinners(),this.scorePage.page.scoreCarsCount()}))}listen(){this.element.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){if(e.target instanceof EventTarget){const t=e.target;if(t.classList.contains("btn-to-garage")&&(this.navigation.toGarage(),this.garagePage.element.classList.remove("none"),this.scorePage.element.classList.add("none")),t.classList.contains("btn-to-winners")&&(this.navigation.toWinners(),this.garagePage.element.classList.add("none"),this.scorePage.element.classList.remove("none")),t.classList.contains("btn-submit")&&this.createNewCar(),t.classList.contains("btn-generate")&&this.generateCars(),t.classList.contains("btn-remove")&&this.removeCar(e),t.classList.contains("btn-select")&&this.checkCarToSelect(e),t.classList.contains("btn-update")){if(!this.currentCarId)return;this.updateCar(this.currentCarId),this.garagePage.switchInputsDisabled(!1),this.disactiveBtns(".btn-select","active")}if(t.classList.contains("btn-next")&&t.classList.contains("garage-btn")){this.garagePage.pagination.slide("garage","next");const e=this.garagePage.pagination.currentPage;this.garagePage.garage.page.garagePage(e)}if(t.classList.contains("btn-prev")&&t.classList.contains("garage-btn")){this.garagePage.pagination.slide("garage","prev");const e=this.garagePage.pagination.currentPage;this.garagePage.garage.page.garagePage(e)}if(t.classList.contains("btn-next")&&t.classList.contains("score")){this.scorePage.pagination.slide("score","next");const e=this.scorePage.pagination.currentPage;this.scorePage.page.garagePage(e)}if(t.classList.contains("btn-prev")&&t.classList.contains("score")){this.scorePage.pagination.slide("score","prev");const e=this.scorePage.pagination.currentPage;this.scorePage.page.garagePage(e)}(t.classList.contains("btn-start")||t.classList.contains("btn-stop"))&&this.checkCarToMove(e)}}))))}disactiveBtns(e,t){document.querySelectorAll(e).forEach((e=>{e.classList.remove(t)}))}createNewCar(){return i(this,void 0,void 0,(function*(){let e=this.garagePage.formCreate.getCarName(),t=this.garagePage.formCreate.getCarColor();e||(e=this.garagePage.formCreate.getRandomName()),"#000000"===t&&(t=this.garagePage.formCreate.getRandomColor());const n=yield this.api.createCar(new h.default(e,t,"0")),i=[new o.default(e,t,n.id)];yield this.garagePage.garage.block.addCars(i),yield this.garagePage.garage.page.garageCarsCount(),yield this.garagePage.pagination.checkBtnsDisabled("garage"),this.garagePage.formCreate.clearInputs(),this.garagePage.switchInputsDisabled(!1),this.disactiveBtns(".btn-select","active")}))}generateCars(){return i(this,void 0,void 0,(function*(){const e=this.garagePage.formCreate.getArrayNames(100),t=this.garagePage.formCreate.getArrayColors(100),n=[];let i;for(let a=0;a<100;a++){const s=new h.default(e[a],t[a],"0");yield this.api.createCar(s),i=new o.default(e[a],t[a],this.api.carId),n.push(i)}this.garagePage.garage.block.addCars(n),this.garagePage.garage.page.garageCarsCount(),this.garagePage.pagination.checkBtnsDisabled("garage"),this.garagePage.switchInputsDisabled(!1),this.disactiveBtns(".btn-select","active")}))}removeCar(e){var t,n;return i(this,void 0,void 0,(function*(){const i=e.target,a=Number(null===(n=null===(t=i.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.id),s=document.getElementById(a.toString());s&&this.garagePage.garage.block.removeCar(s),this.garagePage.garage.page.garageCarsCount(),this.api.deleteCar(a,"/garage"),200===(yield this.api.getWinnerStatus(a))&&(this.api.deleteCar(a,"/winners"),this.scorePage.getWinners(),this.scorePage.page.scoreCarsCount()),this.garagePage.switchInputsDisabled(!1),this.garagePage.pagination.checkBtnsDisabled("garage")}))}checkCarToSelect(e){var t,n;return i(this,void 0,void 0,(function*(){const i=e.target,a=Number(null===(n=null===(t=i.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.id);this.currentCarId=a;const s=yield this.api.getCar(a);this.currentName=s.name,this.currentColor=s.color,this.garagePage.formUpdate.setInput(s.name,"name"),this.garagePage.formUpdate.setInput(s.color,"color"),this.garagePage.switchInputsDisabled(!0),this.disactiveBtns(".btn-select","active"),i.classList.add("active")}))}updateCar(e){return i(this,void 0,void 0,(function*(){const t=document.getElementById("input-name-update"),n=document.getElementById("input-color-update"),i=yield this.garagePage.formUpdate.getCarName(),a=yield this.garagePage.formUpdate.getCarColor();let s="",r="";if(s=this.currentName!==t.value?i:this.currentName,r=this.currentColor!==n.value?a:this.currentColor,s||r){yield this.garagePage.garage.block.updateCar(e.toString(),s,r);const t=new h.default(s,r,e.toString());yield this.api.updateCar(t),yield this.scorePage.getWinners()}this.currentCarId=0,this.currentName="",this.currentColor="",this.garagePage.formUpdate.clearInputs()}))}checkCarToMove(e){var t,n,a;return i(this,void 0,void 0,(function*(){const i=e.target,s=Number(null===(a=null===(n=null===(t=i.parentElement)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.id),r=new o.default("","",s.toString());r.hideMessage(),i.classList.contains("btn-start")?r.startMove(s):i.classList.contains("btn-stop")&&r.stopMove(s)}))}}t.default=u},594:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(933);const a=i(n(583));class s extends a.default{constructor(){super("div",["loader__container"]),this.element.insertAdjacentHTML("beforeend",'\n      <h2 class="loader__title">Loading...</h2>\n      <div class="loader">\n        <span class="loader__element"></span>\n        <span class="loader__element"></span>\n        <span class="loader__element"></span>\n      </div>\n    ')}}t.default=s},908:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(583));class s extends a.default{constructor(){super("div",["navigation"]),this.btnToGarage=new a.default("button",["button","btn-to-garage","active"]),this.btnToWinners=new a.default("button",["button","btn-to-winners"]),this.btnToGarage.element.innerText="To Garage",this.btnToWinners.element.innerText="To Winners",this.element.appendChild(this.btnToGarage.element),this.element.appendChild(this.btnToWinners.element)}toGarage(){this.btnToGarage.element.classList.add("active"),this.btnToWinners.element.classList.remove("active")}toWinners(){this.btnToGarage.element.classList.remove("active"),this.btnToWinners.element.classList.add("active")}}t.default=s},41:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(749);const a=i(n(583));class s extends a.default{constructor(e,t){super("div",[e]),this.header=new a.default("div",[`${t}-header`]),this.garageName=new a.default("div",[`${t}-name`]),this.garageCount=new a.default("div",[`${t}-count`]),this.pages=new a.default("div",[`${t}-pages`]),this.pageName=new a.default("div",[`${t}-page-name`]),this.pageCount=new a.default("div",[`${t}-page-count`]),this.garageName.element.innerText="Garage",this.pageName.element.innerText="Page",this.element.appendChild(this.header.element),this.element.appendChild(this.pages.element),this.header.element.appendChild(this.garageName.element),this.header.element.appendChild(this.garageCount.element),this.pages.element.appendChild(this.pageName.element),this.pages.element.appendChild(this.pageCount.element),this.garagePage()}garageCarsCount(){const e=document.querySelectorAll(".car-block");document.querySelector(".garage-count").innerText=`( ${e.length} )`}garagePage(e=1){this.pageCount.element.innerHTML=`# ${e}`}scoreCarsCount(){const e=document.querySelectorAll(".table-item");document.querySelector(".score-count").innerText=`( ${e.length} )`}}t.default=s},267:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(583));class s extends a.default{constructor(e){super("div",["pagination",e]),this.page={garage:"garage",score:"score"},this.currentPage=1,this.prev=new a.default("button",["button","btn-prev",e]),this.next=new a.default("button",["button","btn-next",e]),this.prev.element.innerText="Previous",this.next.element.innerText="Next",this.element.appendChild(this.prev.element),this.element.appendChild(this.next.element),this.checkBtnsDisabled(this.page.garage),this.checkBtnsDisabled(this.page.score)}getMaxPageCount(e){let t,n;return e===this.page.garage?(t=7,n=document.querySelectorAll(".car-block")):(t=10,n=document.querySelectorAll(".table-item")),Math.ceil(n.length/t)}checkBtnsDisabled(e){const t=this.next.element,n=this.prev.element,i=this.getMaxPageCount(e);1===this.currentPage?(n.disabled=!0,t.disabled=!1):this.currentPage===i?(n.disabled=!1,t.disabled=!0):(n.disabled=!1,t.disabled=!1),1===i&&(n.disabled=!0,t.disabled=!0)}slide(e,t){let n,i;e===this.page.garage?(n=document.querySelector(".cars-wrapper"),i=document.querySelector(".garage-block")):(n=document.querySelector(".table"),i=document.querySelector(".score-table"));const a=null==i?void 0:i.clientHeight,s=this.getMaxPageCount(e);"next"===t?this.currentPage<s&&this.currentPage++:this.currentPage--,n.style.top=`calc(0px - ${a*(this.currentPage-1)}px)`,this.checkBtnsDisabled(e)}}t.default=s},438:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(394);const a=i(n(583)),s=i(n(140));class r extends a.default{constructor(){super("div",["wrapper"]),this.header=new a.default("header",["header"]),this.content=new s.default,this.footer=new a.default("footer",["footer"]),this.element.appendChild(this.header.element),this.element.appendChild(this.content.element),this.element.appendChild(this.footer.element),this.addHeaderContent(),this.addFooterContent()}addHeaderContent(){this.header.element.classList.add("header"),this.header.element.innerText="Async-race"}addFooterContent(){this.footer.element.insertAdjacentHTML("afterbegin","\n      <ul class='footer__list'>\n        <li class='footer__item'>\n          <a class='footer__link' href='https://docs.rs.school/' target='blank'>\n            © Rolling Scopes School\n          </a>\n        </li>\n        <li class='footer__item'>\n          <a class='footer__link' href='https://github.com/Balzamova/async-race' target='blank'>\n            © Anastasiia Balzamova\n          </a>\n        </li>\n      </ul>\n    ")}}t.default=r},599:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(171);const s=a(n(583)),r=a(n(836)),o=a(n(923)),l=a(n(724)),d=a(n(332)),c=a(n(878)),h=a(n(411));class u extends s.default{constructor(e,t,n){super("div",["car-block"]),this.select=new s.default("div",["car-select"]),this.selectBtn=new s.default("button",["button","btn-select"]),this.removeBtn=new s.default("button",["button","btn-remove"]),this.name=new s.default("div",["car-name"]),this.roadBlock=new s.default("div",["car-road-block"]),this.roadBtns=new s.default("div",["road-btns"]),this.start=new s.default("button",["btn-start","active"]),this.stop=new s.default("button",["btn-stop"]),this.road=new s.default("div",["road"]),this.car=new s.default("div",["car"]),this.flag=new s.default("div",["flag"]),this.api=new r.default,this.isWinner=!0,this.isRace=!1,this.addComponentsToBlock(e,t,n)}addComponentsToBlock(e,t,n){this.name.element.innerText=e,this.selectBtn.element.innerText="Select",this.removeBtn.element.innerText="Remove",this.start.element.innerText="A",this.stop.element.innerText="B",this.element.id=n,this.name.element.id=`car-name-${n}`,this.car.element.id=`car-${n}`,this.start.element.id=`btn-start-${n}`,this.stop.element.id=`btn-stop-${n}`,this.flag.element.id=`flag-${n}`,this.stop.element.disabled=!0,this.element.appendChild(this.select.element),this.element.appendChild(this.roadBlock.element),this.select.element.appendChild(this.selectBtn.element),this.select.element.appendChild(this.removeBtn.element),this.select.element.appendChild(this.name.element),this.roadBlock.element.appendChild(this.roadBtns.element),this.roadBlock.element.appendChild(this.road.element),this.roadBtns.element.appendChild(this.start.element),this.roadBtns.element.appendChild(this.stop.element),this.road.element.appendChild(this.car.element),this.road.element.appendChild(this.flag.element),this.car.element.insertAdjacentHTML("afterbegin",this.renderCarImage(t,n)),this.flag.element.insertAdjacentHTML("afterbegin",this.renderFlag())}renderCarImage(e,t){return`\n      <svg id='svg-${t}' style='fill:${e};' version='1.1' xmlns='http://www.w3.org/2000/svg' \n      xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 460.384 460.384' xml:space='preserve'>\n        <g >\n          <path d='M95.252,283.11c-13.807,0-25.039,11.232-25.039,25.039s11.232,25.039,25.039,25.039s25.039-11.233,\n          25.039-25.039 S109.059,283.11,95.252,283.11z M95.252,318.188c-5.536,\n          0-10.039-4.504-10.039-10.039s4.503-10.039, 10.039-10.039 s10.039,4.503,10.039,10.039S100.788,\n          318.188,95.252,318.188z'/>\n          <path d='M357.012,283.11c-13.807,0-25.04,11.232-25.04,25.039s11.233,25.039,25.04,25.039c13.806,0,\n            25.038-11.233,25.038-25.039 S370.818,283.11,357.012,283.11z M357.012,318.188c-5.536,\n            0-10.04-4.504-10.04-10.039s4.504-10.039, 10.04-10.039\n            c5.535,0,10.038,4.503,10.038,10.039S362.547,318.188,357.012,318.188z'/>\n          <path d='M409.227,196.421l-66.917-7.645l-35.714-58.056c-10.905-17.728-30.61-28.741-51.424-28.741H133.676\n            c-34.925,0-65.792,23.518-75.063,57.193l-0.948,3.445c-4.607,16.733-17.845,30.052-34.549,34.762\n            C9.506,201.217,0,213.773,0,227.914v83.012c0,4.142,3.358,7.5,7.5,7.5h38.557c4.757,22.798,25.006,\n            39.978,49.195,39.978 s44.438-17.18,49.195-39.978h163.37c4.757,22.798,25.006,39.978,49.195,\n            39.978s44.438-17.18,49.195-39.978h40.477 c3.813,0,7.02-2.861,7.452-6.65l5.874-51.483C463.614,228.69,\n            440.834,200.037,\n            409.227,196.421z M15,294.313h31.949 c-0.843,2.938-1.43,5.983-1.724,9.113H15V294.313z M95.252,\n            343.404c-19.44,0-35.255-15.815-35.255-35.255 s15.815-35.256,35.255-35.256s35.255,15.816,35.255,\n            35.256S114.692,343.404,95.252,343.404z M357.012,343.404\n            c-19.44,0-35.255-15.815-35.255-35.255s15.815-35.256,35.255-35.256s35.255,15.816,\n            35.255,35.256S376.452,343.404,357.012,343.404z M357.012,257.893c-16.987,0-32.021,8.48-41.122,\n            21.42H182.425c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h126.284\n            c-0.843,2.938-1.43,5.983-1.724,9.113H145.279c-2.389-25.504-23.909-45.533-50.027-45.533c-16.987,0-32.021,\n            8.48-41.122,21.42H15 v-51.399c0-7.455,5.012-14.075,12.187-16.098c21.728-6.126,38.947-23.452,\n            44.94-45.218l0.948-3.445 c7.484-27.186,32.405-46.174,60.601-46.174h121.496c15.643,0,30.452,8.277,38.647,\n            21.6l37.626,61.164 c1.207,1.962,3.249,3.26,5.537,3.522l70.541,8.059c16.002,1.831,28.943,12.335,34.67,\n            26.276h-23.413c-4.142,0-7.5, 3.358-7.5,7.5 s3.358,7.5,7.5,7.5h26.578c0.052,1.975-0.023,3.975-0.253,\n            5.993l-2.364, 20.72h-44.608 C389.033,266.373,373.998,257.893,357.012,257.893z M407.038,\n            303.426c-0.293-3.13-0.881-6.175-1.724-9.113h35.716l-1.04,9.113 H407.038z'/>\n          <path d='M255.565,215.222h-15.76c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h15.76c4.142,0,7.5-3.358,7.5-7.5\n            S259.708,215.222,255.565,215.222z'/>\n          <path d='M154.846,222.722c0-4.142-3.358-7.5-7.5-7.5h-15.76c-4.142,0-7.5,3.358-7.5,7.5s3.358,7.5,7.5,7.5h15.76\n            C151.488,230.222,154.846,226.864,154.846,222.722z'/>\n          <path d='M164.136,283.941c-1.314-3.113-4.658-5.069-8.025-4.546c-3.049,0.474-5.522,2.768-6.213,5.776\n            c-1.496,6.51,6.051,11.564,11.54,7.829C164.343,291.024,165.476,287.186,164.136,283.941\n            C163.946,283.491,164.326,284.401,164.136,283.941z'/>\n          <path d='M286.014,143.391c-6.531-10.637-18.348-17.245-30.841-17.245h-121.5c-24.087,0-45.371,\n            16.217-51.761,39.443l-0.943,3.438 c-2.468,8.956-6.268,24.34-6.429,24.991c-0.553,2.238-0.045,4.606,1.376,\n            6.422c1.422,1.815,3.599,2.876,5.905,2.876h227.64 c2.717,0,5.222-1.469,6.547-3.841c1.326-2.372,\n            1.265-5.275-0.159-7.589L286.014,143.391z M199.352,141.145v47.169h-69.054v-47.018 c1.115-0.098,\n            2.24-0.151,3.375-0.151H199.352z M95.432,173.002l0.944-3.441c2.86-10.395,\n            9.865-18.839,18.922-23.747v42.499H91.432 C92.697,183.321,94.242,177.323,95.432, 173.002z M214.352,\n            188.314v-47.169h40.821c7.316,0,14.235,3.868,18.062,10.1l22.807,37.069 H214.352z'/>\n        </g>\n      </svg>\n    `}renderFlag(){return"\n      <svg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' \n        x='0px' y='0px' viewBox='0 0 498.4 498.4' style='enable-background:new 0 0 498.4 498.4;' xml:space='preserve'>\n        <path style='fill:#009AAF;' \n        d='M333.6,426.4v-20.8c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,19.2v20.8h-48v-20.8c0-10.4-5.6-19.2-16-19.2\n        s-16,8.8-16,19.2v20.8h-48v-20.8c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,\n        19.2v20.8h-48v-20.8c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,19.2 v20.8l0,0v72h272V426.4L333.6,426.4z'/>\n        <path style='fill:#006884;' d='M333.6,498.4v-72l0,0v-20.8c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,19.2v20.8h-48v-20.8\n          c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,19.2v20.8h-48v-20.8c0-10.4-5.6-19.2-16-19.2s-16,8.8-16,19.2v20.8h-48'/>\n        <path style='fill:#EAAA0A;' d='M125.6,418.4v-348c0-4.8-3.2-8.8-8-8.8s-8,4-8,8.8v348H125.6z'/>\n        <circle style='fill:#FF5512;' cx='116' cy='24.8' r='24.8'/>\n        <ellipse transform='matrix(0.6454 -0.7638 0.7638 0.6454 27.7038 83.7364)' style='fill:#FFCDBD;' cx='104.044' \n        cy='12.029' rx='9.6' ry='3.2'/>\n        <path style='fill:#CC3006;' d='M133.6,7.2c9.6,9.6,9.6,25.6,0,35.2s-25.6,9.6-35.2,0'/>\n        <g>\n          <polygon style='fill:#FF5512;' points='133.6,72.8 133.6,191.2 349.6,131.2'/>\n          <polygon style='fill:#FF5512;' points='277.6,185.6 277.6,273.6 436.8,229.6'/>\n        </g>\n        <polygon style='fill:#CC3006;' points='349.6,131.2 349.6,205.6 215.2,168 '/>\n        <g>\n          <circle style='fill:#FFFFFF;' cx='141.6' cy='468' r='8.8'/>\n          <circle style='fill:#FFFFFF;' cx='197.6' cy='468' r='8.8'/>\n          <circle style='fill:#FFFFFF;' cx='253.6' cy='468' r='8.8'/>\n        </g>\n      </svg>\n    "}getTimeToMove(e){return i(this,void 0,void 0,(function*(){const{velocity:t,distance:n}=yield this.api.startEngine(e);return Math.round(n/t)}))}getPosition(e){const t=document.getElementById(e),{top:n,left:i,width:a,height:s}=t.getBoundingClientRect(),r=i+a/2,o=n+s/2;return new h.default(r,o)}getDistance(e){const t=this.getPosition(`car-${e}`),n=this.getPosition(`flag-${e}`),[i,a]=Object.values(t),[s,r]=Object.values(n);return Math.hypot(i-s,a-r)+60}animation(e,t,n){const i=document.getElementById(`car-${e}`);let a=0;return o.default.animation[e]=window.requestAnimationFrame((function s(r){a||(a=r);const l=r-a,d=Math.round(l*(t/n));i.style.transform=`translateX(${Math.min(d,t)}px)`,d<t&&(o.default.animation[e]=window.requestAnimationFrame(s))})),o.default.animation[e]}moveCar(e){return i(this,void 0,void 0,(function*(){const t=yield this.getTimeToMove(e),n=this.getDistance(e);this.animation(e,n,t);const i=yield this.api.drive(e),a=Object.values(i);if(!a[0]){const t=o.default.animation[e];window.cancelAnimationFrame(t)}if(this.isRace&&a[0]&&this.isWinner){const n=this.checkWinner(e,t);this.saveWinner(n),this.isRace=!1}}))}stopCar(e){return i(this,void 0,void 0,(function*(){const t=document.getElementById(`car-${e}`);if(yield this.api.stopEngine(e),o.default.animation[e]){const t=o.default.animation[e];window.cancelAnimationFrame(t)}t.style.transform="translateX(0)"}))}startMove(e){return i(this,void 0,void 0,(function*(){const t=document.getElementById(`btn-start-${e}`),n=document.getElementById(`btn-stop-${e}`);t.disabled=!0,t.classList.toggle("active"),this.moveCar(e),n.disabled=!1,n.classList.toggle("active")}))}stopMove(e){return i(this,void 0,void 0,(function*(){const t=document.getElementById(`btn-stop-${e}`),n=document.getElementById(`btn-start-${e}`);this.stopCar(e),t.disabled=!0,n.disabled=!1,t.classList.toggle("active"),n.classList.toggle("active")}))}startRace(e){return i(this,void 0,void 0,(function*(){(new l.default).raceBtnDisabled(!0),this.isWinner=!0,this.isRace=!0,e.map((e=>i(this,void 0,void 0,(function*(){this.moveCar(e)}))))}))}stopRace(e){return i(this,void 0,void 0,(function*(){e.forEach((e=>i(this,void 0,void 0,(function*(){this.stopCar(e)})))),this.isRace=!1,this.isWinner=!1,(new l.default).raceBtnDisabled(!1)}))}checkWinner(e,t){return this.isWinner=!1,new c.default(e,t)}saveWinner(e){return i(this,void 0,void 0,(function*(){const t=+(e.time/1e3).toFixed(2);this.showMessage(e,t),yield this.api.saveWinner(+e.id,t),yield(new d.default).getWinners()}))}showMessage(e,t){return i(this,void 0,void 0,(function*(){const n=document.querySelector(".message"),i=yield this.api.getCar(+e.id);n.innerText=`${i.name} went first in ${t}s!`,null==n||n.classList.add("visible")}))}hideMessage(){const e=document.querySelector(".message");null==e||e.classList.remove("visible")}}t.default=u},479:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,n){this.name=e,this.color=t,this.id=n}}},724:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n(836)),r=a(n(583)),o=a(n(599));class l extends r.default{constructor(){super("div",["controls"]),this.raceBtn=new r.default("button",["button","btn-race"]),this.resetBtn=new r.default("button",["button","btn-reset"]),this.generateBtn=new r.default("button",["button","btn-generate"]),this.api=new s.default,this.raceBtn.element.innerText="Race",this.resetBtn.element.innerText="Reset",this.generateBtn.element.innerText="Generate",this.element.appendChild(this.raceBtn.element),this.element.appendChild(this.resetBtn.element),this.element.appendChild(this.generateBtn.element),this.listen()}raceBtnDisabled(e){const t=document.querySelector(".btn-race"),n=document.querySelector(".btn-reset");e?(t.disabled=!0,n.disabled=!1):(t.disabled=!1,n.disabled=!0)}listen(){this.element.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){if(e.target instanceof EventTarget){const t=e.target;t.classList.contains("btn-race")&&this.checkCarsToRace("start"),t.classList.contains("btn-reset")&&this.checkCarsToRace("stop")}}))))}checkCarsToRace(e){const t=+document.querySelector(".garage-page-count").innerHTML.slice(2),n=document.querySelectorAll(".car-block"),i=[],a=7*t-1;for(let e=7*(t-1);e<=a;e++)if(n[e]){const t=+n[e].id;i.push(t)}"start"===e?new o.default("","","").startRace(i):new o.default("","","").stopRace(i),new o.default("","","").hideMessage()}}t.default=l},305:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(720);const a=i(n(583));class s extends a.default{constructor(e,t,n,i){super("div",["form",`${e}`]),this.inputName=new a.default("input",["input"]),this.inputColor=new a.default("input",["color"]),this.button=new a.default("button",["button"]),this.addComponents(e,t,n,i)}addComponents(e,t,n,i){this.element.id=e,this.inputName.element.id=t,this.inputName.element.setAttribute("type","text"),this.inputColor.element.id=n,this.inputColor.element.setAttribute("type","color"),this.button.element.innerText=i,this.button.element.classList.add(`btn-${i.toLowerCase()}`),this.element.appendChild(this.inputName.element),this.element.appendChild(this.inputColor.element),this.element.appendChild(this.button.element)}getCarName(){return this.inputName.element.value}getCarColor(){return this.inputColor.element.value}getRandomIndex(e){return Math.floor(Math.random()*e.length)}getRandomName(){const e=["Audi","Bentley","BMV","Tesla","Cadillac","Ford","Lada","Jeep","Kia","Mercedes"],t=["Sedan","Sport","Luxury","Crossover","Electric","MPV","Cabriolet","Coupe","SUV","7"],n=this.getRandomIndex(e),i=this.getRandomIndex(t);return`${e[n]} ${t[i]}`}getRandomColor(){const e="0123456789ABCDEF";let t="#";for(let n=0;n<6;n++)t+=e[this.getRandomIndex(e)];return t}getArrayNames(e){const t=[];for(let n=0;n<e;n++)t.push(this.getRandomName());return t}getArrayColors(e){const t=[];for(let n=0;n<e;n++)t.push(this.getRandomColor());return t}clearInputs(){const e=this.inputName.element,t=this.inputColor.element;e.value="",t.value=""}setInput(e,t){document.getElementById(`input-${t}-update`).value=e}}t.default=s},383:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(741);const a=i(n(583));class s extends a.default{constructor(){super("div",["garage-block"]),this.carsWrapper=new a.default("div",["cars-wrapper"]),this.message=new a.default("div",["message"]),this.element.appendChild(this.carsWrapper.element),this.element.appendChild(this.message.element)}addCars(e){const t=document.querySelector(".cars-wrapper");e.forEach((e=>{null==t||t.appendChild(e.element)}))}removeCar(e){const t=document.querySelector(".cars-wrapper");null==t||t.removeChild(e)}updateCar(e,t,n){const i=document.getElementById(`svg-${e}`),a=document.getElementById(`car-name-${e}`);i.style.fill=n,a.innerText=t}}t.default=s},250:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(583)),s=i(n(267)),r=i(n(724)),o=i(n(305)),l=i(n(228));class d extends a.default{constructor(){super("div",["garage-page"]),this.formCreate=new o.default("form-create","input-name-create","input-color-create","Submit"),this.formUpdate=new o.default("form-update","input-name-update","input-color-update","Update"),this.controls=new r.default,this.garage=new l.default,this.pagination=new s.default("garage-btn"),this.element.appendChild(this.formCreate.element),this.element.appendChild(this.formUpdate.element),this.element.appendChild(this.controls.element),this.element.appendChild(this.garage.element),this.element.appendChild(this.pagination.element),this.switchInputsDisabled()}switchInputsDisabled(e=!1){const t=this.formUpdate.inputName.element,n=this.formUpdate.inputColor.element;t.disabled&&n.disabled&&(t.disabled=e,n.disabled=e),t.disabled=!e,n.disabled=!e}}t.default=d},228:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(583)),s=i(n(41)),r=i(n(383));class o extends a.default{constructor(){super("div",["garage"]),this.page=new s.default("garage","garage"),this.block=new r.default,this.element.appendChild(this.page.element),this.element.appendChild(this.block.element)}}t.default=o},754:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,n){this.id=e,this.wins=t,this.time=n}}},411:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.x=e,this.y=t}}},878:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.id=e,this.time=t}}},332:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n(836)),r=a(n(583)),o=a(n(41)),l=a(n(267)),d=a(n(997)),c=a(n(832));class h extends r.default{constructor(){super("div",["score-page","none"]),this.page=new o.default("score-page","score"),this.header=new r.default("tr",["table-header"]),this.headerNumber=new r.default("th",[]),this.headerCar=new r.default("th",[]),this.headerName=new r.default("th",[]),this.headerWins=new r.default("th",["table-btn","table-btn-win"]),this.headerTime=new r.default("th",["table-btn","table-btn-time"]),this.arrowWin=new r.default("div",["arrow-win"]),this.arrowTime=new r.default("div",["arrow-time"]),this.table=new d.default,this.pagination=new l.default("score"),this.api=new s.default,this.addComponents()}addComponents(){this.element.appendChild(this.page.element),this.element.appendChild(this.header.element),this.element.appendChild(this.table.element),this.element.appendChild(this.pagination.element),this.headerNumber.element.innerText="№",this.headerCar.element.innerText="Car",this.headerName.element.innerText="Name",this.headerWins.element.innerText="Win",this.headerTime.element.innerText="Best time(sec)",this.header.element.appendChild(this.headerNumber.element),this.header.element.appendChild(this.headerCar.element),this.header.element.appendChild(this.headerName.element),this.header.element.appendChild(this.headerWins.element),this.header.element.appendChild(this.headerTime.element),this.headerWins.element.appendChild(this.arrowWin.element),this.headerTime.element.appendChild(this.arrowTime.element),this.sort()}getWinners(){return i(this,void 0,void 0,(function*(){const e=yield this.api.getWinners(),t=[];for(let n=0;n<e.length;n++){const i=+e[n].id;t.push(i)}const n=[];for(let e=0;e<t.length;e++){const i=new c.default(+t[e],e);n.push(i)}this.updateScoreTable(n)}))}updateScoreTable(e){const t=document.querySelector(".table");document.querySelectorAll(".table-item").forEach((e=>{t.removeChild(e)})),e.forEach((e=>{t.appendChild(e.element)})),(new h).page.scoreCarsCount()}sortBy(e){let t;t="wins"===e?this.arrowWin.element:this.arrowTime.element;const n=document.querySelectorAll(`.score-${e}`),i=[];for(let e=0;e<n.length;e++){const t=+n[e].innerHTML,a=+n[e].id.slice(11);i.push([t,a])}t.classList.contains("up")?i.sort(((e,t)=>e[0]-t[0])):i.sort(((e,t)=>t[0]-e[0]));const a=[];for(let e=0;e<i.length;e++){const t=new c.default(+i[e][1],e);a.push(t)}this.updateScoreTable(a)}sort(){this.element.addEventListener("click",(e=>i(this,void 0,void 0,(function*(){if(e.target instanceof EventTarget){const t=e.target;t.classList.contains("table-btn-win")&&(this.arrowWin.element.classList.toggle("up"),this.sortBy("wins")),t.classList.contains("table-btn-time")&&(this.arrowTime.element.classList.toggle("up"),this.sortBy("time"))}}))))}}t.default=h},832:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n(836)),r=a(n(583)),o=a(n(599));class l extends r.default{constructor(e,t){super("tr",["table-item"]),this.number=new r.default("td",["score-number"]),this.image=new r.default("td",["table-img"]),this.name=new r.default("td",["score-name"]),this.wins=new r.default("td",["score-wins"]),this.time=new r.default("td",["score-time"]),this.api=new s.default,this.addWinner(e,t)}addWinner(e,t){return i(this,void 0,void 0,(function*(){const n=yield this.api.getCar(e),i=yield this.api.getWinner(e),a=new o.default(n.name,n.color,e.toString()).renderCarImage(n.color,e.toString());this.wins.element.id=`score-wins-${e}`,this.time.element.id=`score-time-${e}`,this.number.element.innerText=`${t+1}`,this.name.element.innerText=n.name,this.wins.element.innerText=i.wins.toString(),this.time.element.innerText=i.time.toString(),this.image.element.insertAdjacentHTML("afterbegin",a),this.element.appendChild(this.number.element),this.element.appendChild(this.image.element),this.element.appendChild(this.name.element),this.element.appendChild(this.wins.element),this.element.appendChild(this.time.element)}))}}t.default=l},997:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(987);const a=i(n(583));class s extends a.default{constructor(){super("div",["score-table"]),this.table=new a.default("div",["table"]),this.element.appendChild(this.table.element)}}t.default=s},607:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(307);const s=a(n(752)),r=a(n(836)),o=a(n(594));window.onload=()=>{!function(){i(this,void 0,void 0,(function*(){const e=document.querySelector("body");if(!e)throw Error("App element not found");const t=new o.default,n=new r.default;e.append(t.element);const i=yield n.getCars();setTimeout((()=>{new s.default(e),n.getCarArray(i),e.removeChild(t.element)}),1e3)}))}()}},836:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n(140)),r=a(n(754));t.default=class{constructor(){this.baseUrl="https://boiling-fortress-90689.herokuapp.com",this.path={garage:`${this.baseUrl}/garage`,engine:`${this.baseUrl}/engine`,winners:`${this.baseUrl}/winners`},this.carId=""}getCars(){return i(this,void 0,void 0,(function*(){const e=yield fetch(`${this.path.garage}`);return yield e.json()}))}getCarArray(e){const t=[];for(let n=0;n<e.length;n++){const i={name:e[n].name,color:e[n].color,id:e[n].id};t.push(i)}t.length&&(new s.default).checkDB(t)}getCar(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(`${this.path.garage}/${e}`).catch();return yield t.json()}))}createCar(e){return i(this,void 0,void 0,(function*(){const t={name:e.name,color:e.color},n=yield fetch(`${this.path.garage}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),i=yield n.json();return this.carId=yield i.id,i}))}updateCar(e){return i(this,void 0,void 0,(function*(){const t={name:e.name,color:e.color,id:e.id},n=yield fetch(`${this.path.garage}/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return yield n.json()}))}deleteCar(e,t){return i(this,void 0,void 0,(function*(){const n=yield fetch(`${this.baseUrl}${t}/${e}`,{method:"DELETE"});yield n.json()}))}startEngine(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(`${this.path.engine}?id=${e}&status=started`);return yield t.json()}))}stopEngine(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(`${this.path.engine}?id=${e}&status=stopped`);return yield t.json()}))}drive(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(`${this.path.engine}?id=${e}&status=drive`).catch();let n={};return n=200!==(null==t?void 0:t.status)?{success:!1}:yield t.json(),n}))}getWinners(){return i(this,void 0,void 0,(function*(){const e=yield fetch(`${this.path.winners}`);return yield e.json()}))}getWinner(e){return i(this,void 0,void 0,(function*(){const t=yield fetch(`${this.path.winners}/${e}`);return yield t.json()}))}getWinnerStatus(e){return i(this,void 0,void 0,(function*(){return(yield fetch(`${this.path.winners}/${e}`)).status}))}createWinner(e){return i(this,void 0,void 0,(function*(){const t={id:e.id,wins:e.wins,time:e.time},n=yield fetch(`${this.path.winners}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return yield n.json()}))}saveWinner(e,t){return i(this,void 0,void 0,(function*(){if(404===(yield this.getWinnerStatus(e))){const n=new r.default(e,1,t);yield this.createWinner(n)}else{const n=yield this.getWinner(e);let i;i=t<n.time?t:n.time;const a=new r.default(e,n.wins+1,i);yield this.updateWinner(a)}}))}updateWinner(e){return i(this,void 0,void 0,(function*(){const t={id:e.id,wins:e.wins,time:e.time},n=yield fetch(`${this.path.winners}/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return yield n.json()}))}}},923:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={animation:[0]}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();